{"version":3,"sources":["../scripts/videoscript.js"],"names":["VideosSubPage","container","document","querySelector","window","location","href","split","id","playing","videoID","foundVideo","Promise","resolve","reject","xhr","XMLHttpRequest","onload","response","JSON","parse","videoArray","videos","i","length","onerror","open","send","src","displayerror","newHeader","createElement","classList","add","appendChild","createTextNode","title","newVideo","newSource","video","newControlDiv","newButtonRewind","newButtonRewindImage","addEventListener","currentTime","newButtonPlay","newButtonPlayImage","paused","play","pause","newButtonMute","newButtonMuteImage","muted","newButtonFullscreen","newButtonFullscreenImage","requestFullScreen","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","call","newButtonSkip","newButtonSkipImage","timeLeft","duration","console","log","titletext","perror","errortext","load","then","result","display","catch"],"mappings":"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","file":"videoscript.js","sourcesContent":["class VideosSubPage {\r\n  constructor() {\r\n    this.container = document.querySelector('body');\r\n    [, this.id] = window.location.href.split('?id=');\r\n    // Hjálparbreyta til að vita hvenær overlay á að vera til staðar\r\n    this.playing = false;\r\n  }\r\n\r\n  // Einhverskonar startup fall\r\n  // Má copya úr aðalskjali þegar það er til\r\n  load() {\r\n    const videoID = this.id;\r\n    let foundVideo = false;\r\n    return new Promise((resolve, reject) => {\r\n      const xhr = new XMLHttpRequest();\r\n      xhr.onload = function() {\r\n          const response = JSON.parse(this.response);\r\n          const videoArray = response.videos;\r\n          for(let i = 0; i < videoArray.length; i++) {\r\n              //Förum varlega; === gerir ekkert type conversion og virkar ekki,\r\n              //en == virkar hins vegar rétt.\r\n              if(videoArray[i].id == videoID) {\r\n                foundVideo = true;\r\n                resolve(videoArray[i]);\r\n              }\r\n          }\r\n          if(!foundVideo) {\r\n              //Ekkert vídeó með þessu id fannst. Ath. að við erum bara að gera\r\n              //eitt hérna: Lesa úr JSON skrá. Ef það gekk þá skilum við\r\n              //resolve, jafnvel þó vídeóið hafi ekki fundist í skránni.\r\n              //Við þurfum þ.afl. að bregðast við því *annars staðar* ef\r\n              //við gátum opnað JSON en fundum ekkert vídeó með þessu ID.\r\n              //Gerum það í display().\r\n              resolve(null);\r\n          }\r\n      };\r\n      xhr.onerror = reject;\r\n      xhr.open('GET', 'videos.json');\r\n      xhr.send();\r\n  });\r\n\r\n  }\r\n\r\n  // Hjálparfall sem togglar paused overlay\r\n  toggleOverlay() {\r\n\r\n  }\r\n\r\n  // Aðalfall til að birta myndband ef það finnst\r\n  // Inntak er source á vídeói\r\n  // HD: Breytti aðeins. Við þurfum að birta titil, poster ofl.,\r\n  // svo ef þetta er aðalfallið verður src að vera ekki bara\r\n  // slóðin á .mp4 skrána, heldur video hlutur með allar þessar upplýsingar.\r\n  display(src) {\r\n\r\n      if(!src){\r\n          this.displayerror();\r\n          //Viljum við hætta hér með \"return;\" ?\r\n      }\r\n      else {\r\n          //Skellum upp elementum með myndbandinu:\r\n\r\n          const newHeader = document.createElement('h1');\r\n          newHeader.classList.add('title');\r\n          newHeader.appendChild(document.createTextNode(src.title));\r\n          this.container.appendChild(newHeader);\r\n\r\n          const newVideo = document.createElement('video');\r\n          newVideo.classList.add('mainvideo');\r\n\r\n          const newSource = document.createElement('source');\r\n          newSource.classList.add('videosource');\r\n          newSource.src = src.video;\r\n          newVideo.appendChild(newSource);\r\n\r\n//HD: Eftirfarandi kóði lætur allt hverfa. Er annað hvort rangur hjá mér, eða\r\n//þarf CSS stílbrögð sem ákveða hvað sést og hvað ekki.\r\n/*\r\n          const newPoster = document.createElement('img');\r\n          newPoster.classlist.add('overlay');\r\n          newPoster.src = src.poster;\r\n          newVideo.appendChild(newPoster);\r\n          const newPlayButton = document.createElement('img');\r\n          newPlayButton.classlist.add('overlay__play');\r\n          //Varúð, harðkóðað. Gætum líka þurft að parsa .svg skrána eitthvað\r\n          newPlayButton.src = './images/play.svg';\r\n          newVideo.appendChild(newPlayButton);\r\n*/\r\n\r\n          this.container.appendChild(newVideo);\r\n\r\n          const newControlDiv = document.createElement('div');\r\n          newControlDiv.classList.add('controls');\r\n\r\n          const newButtonRewind = document.createElement('button');\r\n          newButtonRewind.id = 'rewind';\r\n          const newButtonRewindImage = document.createElement('img');\r\n          newButtonRewindImage.src = './images/back.svg';\r\n          newButtonRewind.appendChild(newButtonRewindImage);\r\n          newControlDiv.appendChild(newButtonRewind);\r\n\r\n          newButtonRewind.addEventListener('click', function () {\r\n              const currentTime = newVideo.currentTime;\r\n              if(currentTime <= 3){\r\n                  newVideo.currentTime = 0;\r\n              } else {\r\n                  newVideo.currentTime -= 3;\r\n              }\r\n          });\r\n\r\n          const newButtonPlay = document.createElement('button');\r\n          newButtonPlay.id = 'playpause';\r\n          const newButtonPlayImage = document.createElement('img');\r\n          newButtonPlayImage.src = './images/play.svg';\r\n          newButtonPlay.appendChild(newButtonPlayImage);\r\n          newControlDiv.appendChild(newButtonPlay);\r\n\r\n          newButtonPlay.addEventListener('click', function () {\r\n              if (newVideo.paused) {\r\n                newButtonPlayImage.src = './images/pause.svg';\r\n                newVideo.play();\r\n\r\n              } else {\r\n                newButtonPlayImage.src = './images/play.svg';\r\n                newVideo.pause();\r\n              }\r\n          });\r\n\r\n          const newButtonMute = document.createElement('button');\r\n          newButtonMute.id = 'mute';\r\n          const newButtonMuteImage = document.createElement('img');\r\n          newButtonMuteImage.src = './images/mute.svg';\r\n          newButtonMute.appendChild(newButtonMuteImage);\r\n          newControlDiv.appendChild(newButtonMute);\r\n\r\n          newButtonMute.addEventListener('click', function () {\r\n              newVideo.muted = !(newVideo.muted);\r\n          });\r\n\r\n          const newButtonFullscreen = document.createElement('button');\r\n          newButtonFullscreen.id = 'fullscreen';\r\n          const newButtonFullscreenImage = document.createElement('img');\r\n          newButtonFullscreenImage.src = './images/fullscreen.svg';\r\n          newButtonFullscreen.appendChild(newButtonFullscreenImage);\r\n          newControlDiv.appendChild(newButtonFullscreen);\r\n\r\n          newButtonFullscreen.addEventListener('click', function () {\r\n              const requestFullScreen = newVideo.requestFullscreen\r\n                || newVideo.msRequestFullscreen\r\n                || newVideo.mozRequestFullScreen\r\n                || newVideo.webkitRequestFullscreen;\r\n\r\n              requestFullScreen.call(newVideo);\r\n          });\r\n\r\n          const newButtonSkip = document.createElement('button');\r\n          newButtonSkip.id = 'skip';\r\n          const newButtonSkipImage = document.createElement('img');\r\n          newButtonSkipImage.src = './images/next.svg';\r\n          newButtonSkip.appendChild(newButtonSkipImage);\r\n          newControlDiv.appendChild(newButtonSkip);\r\n\r\n          newButtonSkip.addEventListener('click', function () {\r\n              const timeLeft = newVideo.duration - newVideo.currentTime;\r\n              console.log(timeLeft);\r\n              if(timeLeft <= 3){\r\n                  newVideo.currentTime = newVideo.duration;\r\n              } else {\r\n                  newVideo.currentTime += 3;\r\n              }\r\n          });\r\n          this.container.appendChild(newControlDiv);\r\n      }\r\n  }\r\n\r\n  // Fall sem birt er ef ekki tekst að ná í videos.json\r\n  // Er einnig keyrt ef ekki finnst myndband með réttu id\r\n  displayerror() {\r\n    const title = document.createElement('h1');\r\n    title.classList.add('title');\r\n    const titletext = document.createTextNode('Myndbandaleigan');\r\n    title.appendChild(titletext);\r\n    this.container.appendChild(titletext);\r\n    const perror = document.createElement('p');\r\n    perror.classList.add('error');\r\n    const errortext = document.createTextNode('Vídeó fannst ekki!');\r\n    perror.appendChild(errortext);\r\n    this.container.appendChild(perror);\r\n  }\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n  const video = new VideosSubPage();\r\n  video.load()\r\n    .then((result) => {\r\n      video.display(result);\r\n    })\r\n    .catch(() => {\r\n      // Bregðast við villu hérna.\r\n      //ATH: Villa virðist koma upp sama hvað, svo ég kommenta út\r\n      // displayerror fallið þar til við getum leyst þetta - annars\r\n      // strokar það alltaf allt út af skjánum jafnvel ef vídeóið fannst.\r\n      //video.displayerror();\r\n    });\r\n});\r\n"]}