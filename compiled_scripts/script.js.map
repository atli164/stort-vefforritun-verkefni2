{"version":3,"sources":["../scripts/script.js"],"names":["VideosMainPage","container","document","querySelector","Promise","resolve","reject","xhr","XMLHttpRequest","onload","JSON","parse","response","onerror","open","send","parsedResults","proofTwo","console","log","created","date","Date","now","year","years","yearsRounded","Math","floor","concat","toString","month","months","monthsRounded","week","weeks","weeksRounded","day","days","daysRounded","hour","hours","hoursRounded","duration","min","sec","minRounded","minString","secRounded","secString","id","title","dur","age","poster","newbox","createElement","classList","add","href","thumb","src","appendChild","ptime","ptimetext","createTextNode","ptitle","ptitletext","page","pagetext","data","videos","forEach","video","parsedObj","parseAge","length","parseDur","categories","category","catBox","catBoxTitle","actualTitle","cv","createVideoElement","addEventListener","load","then","result","catch"],"mappings":"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","file":"script.js","sourcesContent":["class VideosMainPage {\n  constructor() {\n    this.container = document.querySelector('body');\n  }\n\n  // Einhverskonar startup fall\n  load() {\n    // Dæmi um hvernig mætti nota hrátt callback. Skil eftir ef ske kynni\n    // við vildum frekar nota það.\n    /*  const request = new XMLHttpRequest();\n      request.open('GET', 'videos.json', true);\n      request.onload = function() {\n        if (request.status >= 200 && request.status < 400) {\n\n          const data = JSON.parse(request.response);\n          console.log(data);\n        } else {\n          console.error('Villa', request);\n        }\n      };\n\n      request.onerror = function() {\n        console.error('Óþekkt villa');\n      };\n\n      request.send();\n    */\n\n    // Dæmi #2 um hvernig hægt er að ná í JSON gögn með asynchronous hætti,\n    // í þetta sinn með promises. Aðeins ítarlegra en það sem ég endaði á að\n    // nota, skil það eftir ef við endum á að vilja frekar nota þessa aðferð.\n    /*\n      var request = new Request('videos.json', { method: 'GET' });\n      fetch(request)\n        .then(function(response) {\n          if (response.status === 200) {\n            return response.json();\n          }\n          throw new Error('Something went wrong on api server!');\n        })\n        .then(function(response) {\n          // console.log(response);\n          return response;\n        })\n        .catch(function(error) {\n          console.error(error);\n        });\n     */\n\n\n    return new Promise((resolve, reject) => {\n      const xhr = new XMLHttpRequest();\n      // Búum til private breytu sem geymir rétt scope á this...\n      // const that = this;\n      // console.log(that);\n      // ...sendum svo hana í onload og notum hana í JSON.parse\n      // xhr.onload = (that) => {\n      // Virkaði samt ekki án þess að kasta villu í npm. Notum lambda fall\n      // rétt á meðan við erum að klára aðra virkni.\n      xhr.onload = function () {\n        resolve(JSON.parse(this.response));\n      };\n      xhr.onerror = reject;\n      xhr.open('GET', 'videos.json');\n      xhr.send();\n    });\n  }\n\n  // Throwaway fall til að sýna hvernig við náum gögnum úr asynchronous\n  // promise til að vinna svo með gögnin\n  proofOfConcept(parsedResults) {\n    // console.log(parsedResults);\n    this.proofTwo(parsedResults);\n  }\n\n  // Annað throwaway til að sýna hvernig við hendum gögnum milli falla.\n  proofTwo(parse) {\n    console.log(parse);\n  }\n\n  // Fall sem tekur við created tíma og spýtir út aldursstreng\n  parseAge(created) {\n    const date = new Date(created);\n    const now = new Date();\n    const year = 365 * 24 * 60 * 60 * 1000;\n    if (now - date >= year) {\n      const years = (now - date) / year;\n      // Kippti út years === 1 svo Math.floor(years) skili ekki áfram 1\n      // ef við erum í t.d. 1.9999.\n      // (Það er alveg til umræðu hvort við viljum vera að rúnna niður með\n      // Math.floor() yfirhöfuð; mér finnst það eðlilegast og tel það gera fyrir\n      // sem einfaldastan kóða, en við gætum farið aðrar leiðir)\n      if ((years >= 1) && (years < 2)) {\n        return 'Fyrir 1 ári síðan';\n      }\n      const yearsRounded = Math.floor(years);\n      return 'Fyrir '.concat(yearsRounded.toString(), ' árum síðan');\n    }\n    const month = 30 * 24 * 60 * 60 * 1000;\n    if (now - date >= month) {\n      const months = (now - date) / month;\n      if ((months >= 1) && (months < 2)) {\n        return 'Fyrir 1 mánuði síðan';\n      }\n      const monthsRounded = Math.floor(months);\n      return 'Fyrir '.concat(monthsRounded.toString(), ' mánuðum síðan');\n    }\n    const week = 7 * 24 * 60 * 60 * 1000;\n    if (now - date >= week) {\n      const weeks = (now - date) / week;\n      if ((weeks >= 1) && (weeks < 2)) {\n        return 'Fyrir 1 viku síðan';\n      }\n      const weeksRounded = Math.floor(weeks);\n      return 'Fyrir '.concat(weeksRounded.toString(), ' vikum síðan');\n    }\n    const day = 24 * 60 * 60 * 1000;\n    if (now - date > day) {\n      const days = (now - date) / day;\n      if ((days >= 1) && (days < 2)) {\n        return 'Fyrir 1 degi síðan';\n      }\n      const daysRounded = Math.floor(days);\n      return 'Fyrir '.concat(daysRounded.toString(), ' dögum síðan');\n    }\n    const hour = 60 * 60 * 1000;\n    const hours = (now - date) / hour;\n    if (hours < 1) {\n      return 'Fyrir minna en klukkustund síðan';\n    } else if ((hours >= 1) && (hours < 2)) {\n      return 'Fyrir 1 klukkustund síðan';\n    }\n    const hoursRounded = Math.floor(hours);\n    return 'Fyrir '.concat(hoursRounded.toString(), ' klukkustundum síðan');\n  }\n\n  // Fall sem tekur við duration of spýtir út lengdarstreng\n  parseDur(duration) {\n    // Mögulegt TODO: Bæta við klukkustundarreikningi og viðeigandi return skipun.\n    const min = duration / 60;\n    const sec = duration % 60;\n    // Já, við gætum gert þetta allt með\n    //  return min.toString().concat(':', sec.toString());\n    // en mér er illa við að keyra þrjú föll innan í return setningu - það\n    // leiðir til scope loss og undefined skemmtilegheita.\n    // Tek þetta frekar í sundur fyrir aðeins læsilegri og áreiðanlegri kóða.\n    const minRounded = Math.floor(min);\n    const minString = minRounded.toString();\n    const secRounded = Math.floor(sec);\n    const secString = secRounded.toString();\n    if (secRounded <= 9) {\n      return minString.concat(':0', secString);\n    }\n    return minString.concat(':', secString);\n  }\n\n  // Fall sem býr til eitt div utan um vídeo með aldri, tíma, titli etc.\n  // Kalla þarf á parseföll utan þess falls, þetta tekur við parsed gildum\n  createVideoElement(id, title, dur, age, poster) {\n    const newbox = document.createElement('a');\n    newbox.classList.add('videobox');\n    newbox.href = '/video.html?id='.concat(id.toString());\n    const thumb = document.createElement('img');\n    thumb.classList.add('videobox__img');\n    thumb.src = poster;\n    newbox.appendChild(thumb);\n    const ptime = document.createElement('p');\n    ptime.classList.add('videobox__time');\n    const ptimetext = document.createTextNode(dur);\n    ptime.appendChild(ptimetext);\n    newbox.appendChild(ptime);\n    const ptitle = document.createElement('p');\n    ptitle.classList.add('videobox__title');\n    const ptitletext = document.createTextNode(title);\n    ptitle.appendChild(ptitletext);\n    newbox.appendChild(ptitle);\n    const page = document.createElement('p');\n    page.classList.add('videobox__age');\n    const pagetext = document.createTextNode(age);\n    page.appendChild(pagetext);\n    newbox.appendChild(page);\n    return newbox;\n  }\n\n  // Grunnfall sem tekur parsaða JSON skrána og fer að deila því\n  // út í myndbandsflokka og einstaka vídeó.\n  parse(data) {\n    const videos = {};\n    data.videos.forEach((video) => {\n      const parsedObj = {};\n      parsedObj.id = video.id;\n      parsedObj.title = video.title;\n      parsedObj.age = this.parseAge(video.created);\n      parsedObj.length = this.parseDur(video.duration);\n      parsedObj.thumb = video.poster;\n      videos[video.id] = parsedObj;\n    });\n    data.categories.forEach((category) => {\n      const catBox = document.createElement('section');\n      catBox.classList.add('videocat');\n      const catBoxTitle = document.createElement('h2');\n      catBoxTitle.classList.add('videocat__title');\n      const actualTitle = document.createTextNode(category.title);\n      catBoxTitle.appendChild(actualTitle);\n      category.videos.forEach((video) => {\n        const cv = videos[video];\n        catBox.appendChild(this.createVideoElement(cv.id, cv.title, cv.length, cv.age, cv.thumb));\n      });\n      this.container.appendChild(catBoxTitle);\n      this.container.appendChild(catBox);\n    });\n  }\n}\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const videos = new VideosMainPage();\n\n  videos.load()\n    .then((result) => {\n      // videos.proofOfConcept(result);\n      // console.log(result);\n      videos.parse(result);\n    })\n    .catch(() => {\n      // Bregðast við villu hérna.\n    });\n});\n"]}